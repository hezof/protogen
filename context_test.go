package protogen

import (
	"fmt"
	"path/filepath"
	"strconv"
	"strings"
	"testing"
)

func TestPrintUsage(t *testing.T) {
	fmt.Println(filepath.Join(`D:\tmp\tmp`, `a/b/c`))
}

func TestIt(t *testing.T) {
	var vals [60]string
	const str = `"0":"90926902","1":"90930209","2":"90857674","3":"90934751","4":"90934756","5":"90908870","6":"90962020","7":"90922105","8":"90928034","9":"90963927","10":"90954077","11":"90958390","12":"90979020","13":"90935581","14":"90953708","15":"90921130","16":"90998237","17":"90997201","18":"90940627","19":"90944544","20":"90968041","21":"90887405","22":"90890497","23":"90951192","24":"90915950","25":"90891114","26":"90935442","27":"90946199","28":"90965905","29":"90874083","30":"90896727","31":"90874699","32":"90897240","33":"90960354","34":"90939809","35":"90926509","36":"90917251","37":"90941956","38":"90948025","39":"90925319","40":"90941009","41":"90991916","42":"90960039","43":"90954433","44":"90922399","45":"90942324","46":"90911712","47":"90957909","48":"90946153","49":"90867591","50":"90903001","51":"90943236","52":"90934040","53":"90946498","54":"90923981","55":"90873233","56":"90882512","57":"90916320","58":"90886952","59":"90914407"`
	for _, pair := range strings.Split(strings.TrimSpace(str), ",") {
		pos := strings.IndexByte(pair, ':')
		key, err := strconv.Atoi(strings.ReplaceAll(pair[:pos], `"`, ``))
		if err != nil {
			panic(err)
		}
		val := strings.ReplaceAll(pair[pos+1:], `"`, ``)
		vals[key] = val
	}
	sb := strings.Builder{}
	for i := 0; i < 60; i++ {
		if i > 0 {
			sb.WriteByte(',')
		}
		sb.WriteString(strconv.Itoa(i))
	}
	fmt.Printf(`"kafka_partitions"="%s"`, sb.String())
	fmt.Println(",")
	fmt.Printf(`"kafka_offsets"="%s"`, strings.Join(vals[:], ","))
	fmt.Println()
}
